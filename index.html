<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Irregular Verbs Trainer PRO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-dark">
  <button id="theme-toggle" class="theme-toggle" aria-label="Basculer le thÃ¨me">â˜€ï¸</button>

  <!-- ACCUEIL -->
  <div id="home" class="container">
    <h1>Irregular Verbs Trainer</h1>
    <p class="subtitle">MaÃ®trise les verbes irrÃ©guliers anglais avec diffÃ©rents modes de jeu.</p>
    <button class="primary-btn large" onclick="goToMenu()">ğŸš€ Commencer</button>
  </div>

  <!-- MENU -->
  <div id="menu" class="container hidden">
    <h1>Choisis ton mode</h1>
    <p class="subtitle">Puis sÃ©lectionne la difficultÃ© et le nombre de questions.</p>

    <!-- ğŸ”” INDICATEUR DE SÃ‰ANCE -->
    <div class="session-info">
      <p><strong>â„¹ï¸ SÃ©ance en cours</strong></p>
      <p class="small">
        Tous les exercices rÃ©alisÃ©s sâ€™additionnent dans <strong>un seul QR code</strong>.
        <br>
        âš ï¸ Si tu quittes sans gÃ©nÃ©rer le QR, <strong>les rÃ©sultats seront perdus</strong>.
      </p>
    </div>

    <div class="mode-grid">
      <div class="mode-card" onclick="selectMode('classic', this)">
        <div class="mode-icon">ğŸ“˜</div>
        <div class="mode-title">Classique</div>
        <div class="mode-desc">Choisis past + participle parmi 3 options.</div>
      </div>
      <div class="mode-card" onclick="selectMode('qcm', this)">
        <div class="mode-icon">ğŸ“</div>
        <div class="mode-title">QCM</div>
        <div class="mode-desc">2 Ã©tapes : past puis participle.</div>
      </div>
      <div class="mode-card" onclick="selectMode('learning', this)">
        <div class="mode-icon">ğŸ”</div>
        <div class="mode-title">Apprentissage</div>
        <div class="mode-desc">Repose les verbes ratÃ©s jusquâ€™Ã  maÃ®trise.</div>
      </div>
      <div class="mode-card" onclick="selectMode('exam', this)">
        <div class="mode-icon">â±ï¸</div>
        <div class="mode-title">Examen</div>
        <div class="mode-desc">Chrono + note finale.</div>
      </div>
      <div class="mode-card" onclick="selectMode('puzzle', this)">
        <div class="mode-icon">ğŸ§©</div>
        <div class="mode-title">Puzzle</div>
        <div class="mode-desc">Place chaque forme au bon endroit.</div>
      </div>
      <div class="mode-card" onclick="selectMode('duel', this)">
        <div class="mode-icon">âš”ï¸</div>
        <div class="mode-title">Duel</div>
        <div class="mode-desc">2 joueurs, meilleur score gagne.</div>
      </div>
      <div class="mode-card" onclick="selectMode('flashcards', this)">
        <div class="mode-icon">ğŸ´</div>
        <div class="mode-title">Flashcards</div>
        <div class="mode-desc">Retourne la carte, auto-Ã©value-toi.</div>
      </div>
    </div>

    <h2 class="section-title">DifficultÃ©</h2>
    <div class="difficulty-buttons">
      <button onclick="setDifficulty(1, this)">â­ Niveau 1</button>
      <button onclick="setDifficulty(2, this)">â­â­ Niveau 2</button>
      <button onclick="setDifficulty(3, this)">â­â­â­ Niveau 3</button>
    </div>

    <h2 class="section-title">Nombre de questions</h2>
    <div class="question-buttons">
      <button onclick="selectQuestionCount(5, this)">5</button>
      <button onclick="selectQuestionCount(10, this)">10</button>
      <button onclick="selectQuestionCount(15, this)">15</button>
      <button onclick="selectQuestionCount(20, this)">20</button>
    </div>

    <button class="danger-btn" onclick="backHome()">â¬… Retour</button>
  </div>

  <!-- JEU -->
  <div id="game" class="container hidden">
    <h1 id="game-title">Modeâ€¦</h1>
    <div class="top-infos">
      <div id="question-counter"></div>
      <div id="timer"></div>
    </div>

    <div id="duel-players" class="duel-players hidden">
      <div id="player1-card" class="duel-player-card">
        <div class="duel-player-name">Joueur 1</div>
        <div class="duel-player-score" id="player1-score">0</div>
      </div>
      <div id="player2-card" class="duel-player-card">
        <div class="duel-player-name">Joueur 2</div>
        <div class="duel-player-score" id="player2-score">0</div>
      </div>
    </div>

    <div id="duel-info"></div>
    <div id="word">...</div>

    <button id="toggle-translation" class="secondary-btn">ğŸ“˜ Voir la traduction</button>
    <div id="translation"></div>

    <div id="step-label"></div>
    <div id="btn-group"></div>
    <div id="puzzle-area"></div>
    <div id="feedback"></div>

    <button id="next" class="primary-btn" onclick="nextQuestion()">Suivant âœ</button>
  </div>

  <!-- RÃ‰SULTAT -->
  <div id="result" class="container hidden">
    <h1>RÃ©sultat</h1>
    <h2 id="score-text"></h2>
    <div id="badge-row"></div>
    <div id="summary"></div>
    <div id="mistake-list"></div>
    <div class="result-actions">
      <button id="result-continue-btn" class="primary-btn">â¬… Continuer un autre exercice</button>
      <button id="result-finish-btn" class="secondary-btn">ğŸ“¥ TÃ©lÃ©charger le QR (ScanProf)</button>
    </div>
    <div id="session-history" class="session-history"></div>

    <button class="danger-btn" onclick="restart()">
      ğŸ†• Nouvelle sÃ©ance (âš ï¸ rÃ©initialise tout)
    </button>
  </div>

  <!-- MODALES -->
  <div id="identity-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <h2>Bienvenue ğŸ‘‹</h2>
      <input id="student-firstname" placeholder="PrÃ©nom">
      <input id="student-lastname" placeholder="Nom (optionnel)">
      <input id="student-class" placeholder="Classe">
      <button onclick="saveIdentity()">Valider</button>
    </div>
  </div>

  <div id="session-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <h2>Fin de l'exercice</h2>
      <p class="small">
        ğŸ‘‰ Continuer = ajouter un exercice au QR  
        <br>
        ğŸ‘‰ Terminer = gÃ©nÃ©rer le QR final
      </p>
      <button id="session-continue-btn">Continuer</button>
      <button id="session-qr-btn">Terminer et gÃ©nÃ©rer le QR</button>
    </div>
  </div>

  <div id="qr-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content qr-modal">
      <div id="qr-section" class="qr-section">
        <h2 id="qr-modal-title">QR ScanProf prÃªt Ã  scanner</h2>
        <p class="subtitle small">
          âš ï¸ Ce QR contient <strong>toute la sÃ©ance</strong>.  
          Scanne-le immÃ©diatement avec l'app ScanProf ou sauvegarde-le en PNG.
        </p>
        <div id="qrBox"></div>
        <button id="download-qr-btn" class="secondary-btn">ğŸ’¾ Enregistrer le QR en PNG</button>
        <button id="close-qr-modal" class="danger-btn">Fermer</button>
      </div>
    </div>
  </div>

  <script src="verbs-data.js"></script>
  <script src="qrcode.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
